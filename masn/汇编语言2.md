# 寄存器 (CPU工作原理)



### CPU概述

CPU由 运算器 控制器 寄存器等器件组成 通过内部总线链接

内部总线实现CPU内部各器件之间的联系

外部总线实现CPU和主板上其他器件的联系

## 寄存器

8086有14个寄存器(都是16位的) 可以存放两个字节  
**如果超出16位 只保留低位 高位另有去处**
	
AX 、BX 、CX、 DX 、 SI 、DI 、 SP 、 BP、 IP、 CS 、 SS 、 DS 、 ES 、 PSW

### 通用寄存器

AX BX CX DX  通常用来存放一般性数据 称为通用寄存器
上一代的cpu寄存器都是8位的 为了兼容 这4个寄存器可以**分为两个独立的8位寄存器使用**

AX = AH(高8位) + AL(低8位)  
BX = BH + BL  
CX = CH + CL  
DX = DH + DL


> 16位数据在寄存器中的存放情况

	10进制 -> 二进制 -> 寄存器存储 （15位-0位）
	18 -> 10010 -> 0000 0000 0001 0010
	20000 -> 0100 1110 0010 0000 ->   0100 1110 0010 0000

**16位寄存器所能存储的数据最大值是 2的16次方 - 1**
	

> 汇编指令
	
	汇编指令   	CPU操作        	高级语言描述
	mov ax,18 	18送入ax寄存器  	ax=18
	add ax,8	将ax中的数加上8   ax=ax+8
	mov ax,bx   bx中的数据送入ax  ax=bx
	add ax,bx	ax bx相加存入ax  ax=ax+bx

> 16位结构的CPU特征 

- 运算器一次最多处理16位的数据
- 寄存器最大宽度16位
- 寄存器和运算器之间的通路是16位( 决定了内部的寻址能力 64K)

### 寻址方式

8086外部有20位地址总线 寻址能力为1M

**16位段地址** + **16位偏移地址** 经过 **地址加法器**  得出20位的物理地址 

> 物理地址生成方法 （段地址*16+偏移地址=物理地址） 

段地址 ： 1230H
偏移地址： 00C8H

1. 段地址*16 . 	`1230H * 16 = 12300H`
2. *16后的段地址与偏移地址相加 `12300H + 00C8H = 123C8H`


### 段的概念

**WARNING（错误认识）：** 内存被划分为一个一个段 每个段都个段地址

段的划分来自于CPU。CPU寻址能力的无法直接寻址全部内存所以CPU用分段的方式来管理内存。

每个段最大长度：等于偏移地址的最大寻址能力 64k

编程时根据需要将若干连续的内存地址看做一个段

可以根据需要将地址连续 起始地址为16倍数的一组内存单元定义为一个段 

用段地址*16定位段的起始地址

用偏移地址定位段中的内存单元

CPU可以通过不同的段地址和偏移地址形成同一个物理地址

